# Haddan bot
Приложение с дружелюбным пользовательским интерфейсом для автоматизации различных действий в ~~суперпопулярной~~ браузерной игре haddan.ru


## Функции приложения

- Автоматический фарм полян
- Автоматическое проведение боя с выбором заклинаний.
- Отправка уведомлений в телеграм (капча, дух ума)
- Прохождение лабиринта древних руин
- Фарм ЦУ, побережья, лабиринта
- Фарм пыльных драконов

## Стек технологий

### Backend

- Python(tkinter, selenium)

### Инструменты разработки
- Git (система контроля версий)


## Инструкция по применению
Работа программы основана на запуске независимого сеанса браузера Google Chrome, который должен быть установлен у Вас на ПК.
Если Google Chrome не установлен, загрузите с официального сайта последнюю версию и установите её  *https://www.google.ru/chrome/*

### Запуск программы

Для запуска бота введите имя и пароль от вашего персонажа и нажмите кнопку **войти**
Чтобы каждый раз при запуске программы не вводить имя и пароль, заполните две переменные в файле .env, приложенному к программе.

Все доступные переменные файла .env для дефолтного запуска:

TELEGRAM_CHAT_ID - ваш телеграм ID для отправки уведомлений(узнать ваш id можно через этот бот https://dzen.ru/away?to=https%3A%2F%2Ft.me%2Fgetmyid_bot)
FIRST_CHAR - имя персонажа
HADDAN_PASSWORD - пароль от персонажа
HADDAN_URL - адрес хаддана, по умолчанию https://haddan.ru/
MIN_HP_VALUE - минимальный уровень ХП персонажа, по умолчанию 0
MIND_SPIRIT_PLAY - автоигра с духом ума(True или False), по умолчанию True
CHEERFULNESS - атоматичнское пополнение бодрости(True или False), по умолчанию False
DEFAULT_SLOTS_PAGE - дефолтная страница быстрых слотов, по умолчанию 2
DEFAULT_SLOT - дефолтный слот, по умолчанию 1
DEFAULT_CHEERFULNESS_SLOTS_PAGE - дефолтная страница быстрых слотов для эликов бодры, по умолчанию 1(страница напитков)
DEFAULT_CHEERFULNESS_SLOT - дефолтный слот для эликов бодры, по умолчанию 1(первый слот)

После входа в игру Вы можете играть в haddan как обычно. Запущенная сессия практически ничем не отличается от обычного входа в игру через другой браузер.
!!!ВАЖНО!!!  - не закрывайте крестиком эти сессии как обычный браузер. Для корректного завершения работы нужно нажимать кнопку **закрыть**

После первого входа в игру, рядом с исполняемым файлом main.exe будет создана папка с кешем браузера - hd_windows_profile.
Если необходимо почистить кеш, просто удалите её.

### Управление программой

Работа бота основана на запуске циклов в нужное время и нужном месте (кнопки **старт**)
При запуске любого из циклов бот берёт настройки из "чекбоксов" приложения и запускает определённый алгоритм действий.
Запустить два цикла одновременно невозможно. При старте нового цикла нужно дожидаться пока предыдущий закончит работу.
Выбираете нужные параметры - нажимаете **старт**. Если необходимо срочно остановить цикл, нажмите **стоп** и обновите страницу.


Настройки и их обозначение:

- Отправлять сообщение в телеграм (пока только для разработчиков, без указания токена вашего телеграм бота и телеграм id в файле .env работать не будет)
- Бегать верх-вниз  - работает при включенном цикле фарма, в ЦУ, лабиринте древних руин и на побережье. Бегает верх-вниз (на побережье только в центре, где нападают 2-3 моба)
- Бегать влево-вправо - работает при включенном цикле фарма, в ЦУ и лабиринте древних руин. Бегает влево-вправо
- автоигра с духом ума - автоматические проводит лёгкую игру с духом ума. Если галочка не стоит, при встрече с духом ума выдаёт всплывашку и ждёт 30 сек
- минимум ХП - если ХП падает ниже установленного минимума, выдаёт всплывашку и ждёт 30 сек
- Пить бодру - если включено, будет глотать элик, который указан в слоте правее. !!! Осторожно, сожрёт все элики в указанном слоте, если там окажется что-то не для  бодрости !!!

!!!ВАЖНО!!! = перед тем как закрыть программу, нажмите кнопку **закрыть** для корректного завершения работы сессии GoogleChrome. И только после этого закрывайте крестиком саму программу. Это необходимо для избежания возможных ошибок некорректного закрытия програмного драйвера.


### Настройка слотов

Настройка каждого удара состоит из двух частей. Слот / заклинание. 
Слоты от 1 до 7, где 1 - страница с эликсирами, 2 - первая страница быстрых слотов, 3 - вторая страница быстрых слотов и тд.
Заклинание от 1 до 7, где 1 - первое заклинание(сверху слева), 2 - второе заклинание и тд.

Например элик бодрости по умолчанию это страница быстрых слотов с напитками(1) и самый первый слот(1)

Главный удар настраивается под лейблом **Фарм** (любой удар в любом раунде сверх того что настроено вручную, будет использовать этот слот)
Чтобы синхронизировать все настраиваемые удары с основным, настройте основной закл и нажмите кнопку **sync**

### Основные циклы

- **Фарм поляны**

При нахождении рядом с феей поляны нажимаем кнопку **старт** и фарм полянки запускается.

Бот автоматически выбирает самый выгодный ресурс из предложенных.
Цены на ресурсы можно установить вручную, либо синхпронизировать с поисковиком сайта ордена пегаса. Чтобы это сделать, при незапущенном цикле нажмите кнопку **синхра цен с поисковиком** 

- **Прохождение лабиринта**

Перед стартом прохождения лабиринта убедитесь, что карта полностью открыта. Данные берутся из сайта Вадима *https://haddan.novikovproject.ru/maze?level=1*

Перед началом цикла выберите только один этаж, на котором вы находитесь.
Укажите целевую комнату если нужно закончить путь в конкретном месте.
Поставьте галочку "через весь дроп", если хотите, чтобы путь был проложен через все сундуки и горы черепов.

Если не указана целевая комната и не стоит галочка "через весь дроп":
 - 1й этаж - идёт напрямую до портала на второй этаж
 - 2й этаж - идёт напрямую до портала на третий этаж
 - 3й этаж - идёт напрямую до лича

Если не указана целевая комната и стоит галочка "через весь дроп":
 - 1й этаж - проходит через весь дроп до портала на 2й этаж
 - 2й этаж - ппроходит через весь дроп до портала в город

 !!!ВАЖНО!!! - после того как нажата кнопка старт и началось прохождение, не делайте никаких действий, это приведёт к потере маршрута.
 !!! update !!! = бот научился запоминать пройденные комнаты в лабиринте. Теперь можно останавливать и запускать цикл прохождения сколько угодно, 
 маршрут всегда будет формироваться с учётом пройденных комнат. 

 Если по какой-то причине маршрут сбился, нажмите кнопку **стоп** и начните цикл заново. 

Память очищается при перезапуске приложения и при нажатии кнопки **очистить карты**


 - **Фарм**

Автобой с заданными параметрами.
При нахождении в ЦУ, лабе и побережье очень актуальны параметры "бегать верх вниз" и бегать "влево вправо"
Если нужно по каким-то причинам срочно остановить фарм, нажимайте **стоп** и обновляйте страницу.

- **Фарм драконов**

Логика фарма пыльных драконов.
Выбрали нужные параметры, слоты, нажали кнопку **старт**
Целесообразно запускать цикл только если вы находитесь в одной локации с драконом.

- **Прохождение леса**

Пришли в лес - нажали старт.
Можно останавливать и запускать заново, пройденные комнаты запоминаются.
Можно стартовать из любой комнаты.


### ВАЖНО ###

Перед тем как закрыть программу, всегда нажимайте кнопку **закрыть** для корректного завершения работы сессии GoogleChrome. И только после этого закрывайте крестиком саму программу. Это необходимо для избежания возможных ошибок некорректного закрытия програмного драйвера.



## Развертывание проекта (для разработчиков)
Для полноценной работы приложения необходимо создать файл .env со следующими переменными

TELEGRAM_BOT_TOKEN - токен TG бота
TELEGRAM_CHAT_ID - ваш телеграм id для уведомлений

опционально:
FIRST_CHAR - имя персонажа
HADDAN_PASSWORD - пароль от персонажа
HADDAN_URL - адрес хаддана, по умолчанию https://haddan.ru/
MIN_HP_VALUE - минимальный уровень ХП персонажа, по умолчанию 0
MIND_SPIRIT_PLAY - автоигра с духом ума(True или False), по умолчанию True
CHEERFULNESS - атоматичнское пополнение бодрости(True или False), по умолчанию False
DEFAULT_SLOTS_PAGE - дефолтная страница быстрых слотов, по умолчанию 2
DEFAULT_SLOT - дефолтный слот, по умолчанию 1


Если не указать имя и пароль от персонажа, их придётся каждый раз вводить вручную при запуске приложения.
Если не указать переменные для телеграма - функционал отправки сообщений в телеграм работать не будет

## Автор

Александров Дмитрий

<u>GitHub</u>
 - https://github.com/DmitryAlexandrov91

